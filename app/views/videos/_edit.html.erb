<div class="modal-dialog modal-lg modal-dialog-center">
  <div class="modal-content">
    <div class="modal-header">
      <h1 class="modal-title">動画情報設定</h1>
    </div>
    <div class="modal-body">
      <div class="content">
        <%= form_with(model: @video, url:video_path(@video), local:false ) do |f| %>
          <%= render '/shared/error_messages', object: f.object %>
          <div class="field">
            <%= f.label :title, class: "video-label" %><br>
            <%= f.text_field :title, id: "title_edit" %><br>
          </div>
          <div class="field">
            <%= f.label :open_period, class: "video-label" %><br>
            <%= f.datetime_field :open_period , id:"open_period_edit" %> 
            <!-- 公開期間を過ぎた後の対応の選択エリア -->
            <div class="expire_type_choice_edit" style="display: none; background-color: #FFDDFF">
              <span>公開期間を過ぎた後の対応を選択してください</span><br>
              <%= f.radio_button :expire_type, Video.expire_types.key(0), checked: "checked" %>
              <%= f.label :expire_type, Video.expire_types_i18n[:nonpublic], value: Video.expire_types.key(0), class: "video_label" %>
              <% if current_system_admin || current_user&.owner? %>
                <%= f.radio_button :expire_type, Video.expire_types.key(1) %>
                <%= f.label :expire_type, Video.expire_types_i18n[:deactivate], value: Video.expire_types.key(1), class: "video_label" %>
              <% end %>
            </div>
            <!-- ここまで -->
          </div>
          <div class="field">
            <%= f.label :range, class: "video-label" %><br>   
            <%= f.select :range, [['一般公開',0],['限定公開',1]], { include_blank: false, selected: @video.selected_before_range }, id:"range_edit" %>  
          </div> 

          <div class="field">
            <%= f.label :comment_public, class: "video-label" %><br>
            <%= f.select :comment_public, [['公開',0],['非公開',1]], { include_blank: false, selected: @video.selected_before_comment_public },  id:"comment_public_edit" %>
          </div> 
          <div class= "field">
            <%= f.label :login_set, class: "video-label" %><br>     
            <%= f.select :login_set, [['ログイン不要',0],['ログイン必要',1]], { include_blank: false, selected: @video.selected_before_login_set }, id:"login_set_edit" %> 
          </div>
          <div class="field">
            <%= f.label :popup_before_video, class: "video-label" %><br>
            <%= f.select :popup_before_video, [['動画視聴開始時ポップアップ表示',0],['動画視聴開始時ポップアップ非表示',1]], { include_blank: false, selected: @video.selected_before_popup_before_video }, id:"popup_before_video_edit" %>
          </div> 
          <div class="field">
            <%= f.label :popup_after_video, class: "video-label" %><br>
            <%= f.select :popup_after_video, [['動画視聴終了時ポップアップ表示',0],['動画視聴終了時ポップアップ非表示',1]], { include_blank: false, selected: @video.selected_before_popup_after_video }, id:"popup_after_video_edit" %>
          </div>      

          <!-- video_folder中間モデル作成後、folder名一覧をここに表示予定 -->
        
          <div class="video-post-actions">   
            <% if system_admin_signed_in? || @video.my_upload?(current_user) || @video.ensure_owner?(current_user) %> 
              <%= f.submit "設定を変更", class: "btn btn-primary" %>   
            <% end %>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<script>
// 公開期間設定後の対応選択エリア表示・非表示
  jQuery(function($){
    $('#open_period_edit').on('input', function(){
      if ($('#open_period_edit').val()) {
        $('.expire_type_choice_edit').show().css('background-color', '#FFDDFF');
      }else{
        $('.expire_type_choice_edit').hide();
      }
    });

    // 公開期間が既存値を持つ場合は選択エリアを表示
    if ($('#open_period_edit').val()) {
      $('.expire_type_choice_edit').show().css('background-color', '#FFDDFF');
    }
  });
</script>
